<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Usuario | BarberShop</title>

    <!-- BOOTSTRAP -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- SWEETALERT2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- ICONOS BOOTSTRAP -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />

    <!-- ESTILOS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
  </head>

  <body>
    
      <nav class="sidebar bg-dark text-white p-3">
        <h4 class="text-center mb-4">BarberShop</h4>

        <ul class="nav nav-pills flex-column mb-auto">
          <li class="nav-item">
            <a href="/dashboard/usuario" class="nav-link active">
              <i class="bi bi-person-circle me-2"></i> Mi Panel
            </a>
          </li>

          <li>
            <a href="/citas/mis-citas" class="nav-link text-white">
              <i class="bi bi-calendar-week me-2"></i> Mis Citas
            </a>
          </li>

          <li>
            <a href="/pedidos/mis-pedidos" class="nav-link text-white">
              <i class="bi bi-receipt me-2"></i> Mis Pedidos
            </a>
          </li>

          <li>
            <a href="/barberos" class="nav-link text-white">
              <i class="bi bi-scissors me-2"></i> Barberos
            </a>
          </li>

          <li>
            <a href="/productos" class="nav-link text-white">
              <i class="bi bi-shop me-2"></i> Productos
            </a>
          </li>
        </ul>

        <hr class="text-secondary" />

        <div class="mt-auto">
          <a href="/logout" class="btn btn-outline-light w-100">
            <i class="bi bi-box-arrow-right me-1"></i> Cerrar sesiÃ³n
          </a>
        </div>
      </nav>

      <!-- CONTENIDO PRINCIPAL -->
      <div class="container-fluid p-4">
        <!-- BIENVENIDA -->
        <div
          class="welcome-box text-white rounded p-4 mb-4 shadow"
          style="background: linear-gradient(135deg, #20c997, #0d935f)"
        >
          <h3 class="fw-bold">Hola, {{ usuario.nombre }} ðŸ‘‹</h3>
          <p class="mb-0">
            Este es tu panel. Desde aquÃ­ puedes ver tus citas, pedidos y acceder
            a la tienda.
          </p>
        </div>
      </div>

        <!-- TARJETAS -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <div class="card shadow-sm border-0">
              <div class="card-body">
                <h6 class="text-muted">Citas pendientes</h6>
                <h2 class="fw-bold">{{ citas_pendientes }}</h2>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="card shadow-sm border-0">
              <div class="card-body">
                <h6 class="text-muted">PrÃ³xima cita</h6>
                {% if proxima_cita %}
                <p class="mb-1 fw-bold">
                  {{ proxima_cita.fecha }} - {{ proxima_cita.hora }}
                </p>
                <small class="text-muted"
                  >Con {{ proxima_cita.peluquero_nombre }}</small
                >
                {% else %}
                <h2 class="fw-bold">â€”</h2>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="card shadow-sm border-0">
              <div class="card-body">
                <h6 class="text-muted">Pedidos en curso</h6>
                <h2 class="fw-bold">{{ pedidos_en_curso }}</h2>
              </div>
            </div>
          </div>
        </div>

        <!-- ACCESOS RÃPIDOS -->
        <h4 class="fw-bold mb-3">Accesos rÃ¡pidos</h4>

        <div class="row g-3 mb-4">
          <div class="col-md-3">
            <a
              href="/citas/agendar"
              class="btn btn-success w-100 py-3 shadow-sm"
            >
              <i class="bi bi-plus-circle fs-3 d-block mb-1"></i>
              Agendar cita
            </a>
          </div>

          <div class="col-md-3">
            <a
              href="/citas/mis-citas"
              class="btn btn-primary w-100 py-3 shadow-sm"
            >
              <i class="bi bi-list-check fs-3 d-block mb-1"></i>
              Ver mis citas
            </a>
          </div>

          <div class="col-md-3">
            <a
              href="/pedidos/mis-pedidos"
              class="btn btn-warning w-100 py-3 shadow-sm"
            >
              <i class="bi bi-receipt fs-3 d-block mb-1"></i>
              Mis pedidos
            </a>
          </div>

          <div class="col-md-3">
            <a href="/productos" class="btn btn-dark w-100 py-3 shadow-sm">
              <i class="bi bi-bag fs-3 d-block mb-1"></i>
              Ir a la tienda
            </a>
          </div>
        </div>

        <!-- TABLA: ÃšLTIMAS CITAS -->
        <div class="card shadow-sm border-0 mb-4">
          <div class="card-body">
            <h5 class="fw-bold mb-3">Mis Ãºltimas citas</h5>

            <div class="table-responsive">
              <table class="table table-hover align-middle">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Barbero</th>
                    <th>Fecha</th>
                    <th>Hora</th>
                    <th>Estado</th>
                  </tr>
                </thead>

                <tbody>
                  {% for c in ultimas_citas %}
                  <tr>
                    <td>{{ c.id }}</td>
                    <td>{{ c.peluquero_nombre }}</td>
                    <td>{{ c.fecha }}</td>
                    <td>{{ c.hora }}</td>
                    <td><span class="badge bg-info">{{ c.estado }}</span></td>
                  </tr>
                  {% else %}
                  <tr>
                    <td colspan="5" class="text-center py-3 text-muted">
                      No tienes citas recientes.
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- TABLA: ÃšLTIMOS PEDIDOS -->
        <div class="card shadow-sm border-0 mb-5">
          <div class="card-body">
            <h5 class="fw-bold mb-3">Mis Ãºltimos pedidos</h5>

            <div class="table-responsive">
              <table class="table table-hover align-middle">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Total</th>
                    <th>Estado</th>
                    <th>Fecha</th>
                  </tr>
                </thead>

                <tbody>
                  {% for p in ultimos_pedidos %}
                  <tr>
                    <td>{{ p.id }}</td>
                    <td>${{ p.total }}</td>
                    <td>
                      <span class="badge bg-warning">{{ p.estado }}</span>
                    </td>
                    <td>{{ p.fecha }}</td>
                  </tr>
                  {% else %}
                  <tr>
                    <td colspan="4" class="text-center py-3 text-muted">
                      No tienes pedidos recientes.
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
