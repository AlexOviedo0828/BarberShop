<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Mis Citas | BarberShop</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/mis_citas.css') }}"
    />

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>

  <body>
    <div class="container mt-5 pt-4">
      <div class="glass-card p-4 mx-auto mb-4" style="max-width: 2000px">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h3 class="section-title">
            <i class="bi bi-calendar-check"></i> Mis Citas
          </h3>
          <div class="right text-end">
            <a href="/dashboard/admin" class="btn btn-outline-light">
              <i class="bi bi-arrow-left me-1"></i> Volver
            </a>
          </div>
        </div>

        {% if not citas_pendientes and not proxima_cita %}
        <div class="text-center py-5">
          <i class="bi bi-calendar-x fs-1"></i>
          <p class="mt-3 mb-0">No tienes citas agendadas.</p>
        </div>
        {% endif %} {% if proxima_cita %}
        <div class="glass-subcard p-3 mb-4">
          <h5 class="fw-bold text-primary">
            <i class="bi bi-star-fill"></i> Próxima cita
          </h5>

          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h5 class="m-0 text-white">
                {{ proxima_cita.fecha }} • {{ proxima_cita.hora }}
              </h5>
              <small class="text-white">
                Con {{ proxima_cita.peluquero_nombre }}
              </small>
            </div>
            <div class="d-flex align-items-center gap-3">
            <span class="badge bg-success"
              >{{ proxima_cita.estado|upper }}</span
            >

            <button
              class="btn btn-danger btn-sm"
              onclick="cancelarCita({{ proxima_cita.id }})"
            >
              <i class="bi bi-trash"></i>
            </button>
            </div>
          </div>
        </div>
      </div>

      <div class="glass-card p-4 mx-auto" style="max-width: 2000px">
        {% endif %} {% if citas_pendientes %}
        <h5 class="fw-bold ms-1 mb-3 text-primary">Otras citas pendientes</h5>

        {% for c in citas_pendientes %}
        <div
          class="glass-subcard p-3 d-flex justify-content-between align-items-center mb-4"
        >
          <div>
            <h6 class="fw-bold mb-0 text-white">{{ c.fecha }} • {{ c.hora }}</h6>
            <small class="text-white">Con {{ c.peluquero_nombre }}</small>
          </div>

          <div class="d-flex align-items-center">
            <span class="badge bg-warning text-dark me-3">
              {{ c.estado|upper }}
            </span>

            <button
              class="btn btn-danger btn-sm"
              onclick="cancelarCita({{ c.id }})"
            >
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </div>
        {% endfor %} {% endif %}
      </div>
    </div>

    <script>
      function cancelarCita(id) {
        Swal.fire({
          title: "¿Cancelar cita?",
          text: "Esta acción no se puede deshacer.",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#d33",
          cancelButtonColor: "#3085d6",
          confirmButtonText: "Cancelar cita",
          cancelButtonText: "Volver",
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = `/citas/cancelar/${id}`;
          }
        });
      }
    </script>
  </body>
</html>